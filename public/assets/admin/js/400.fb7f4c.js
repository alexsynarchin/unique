"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[400],{95844:(t,e,o)=>{function r(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}o.d(e,{D:()=>a});var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors={}}var e,o,a;return e=t,(o=[{key:"has",value:function(t){return this.errors.hasOwnProperty(t)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(t){if(this.errors[t])return this.errors[t][0]}},{key:"getFlash",value:function(t){if(this.errors[t])return this.errors[t]}},{key:"record",value:function(t){this.errors=t}},{key:"clear",value:function(t){t?this.has(t)&&delete this.errors[t]:this.errors={}}}])&&r(e.prototype,o),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}()},59400:(t,e,o)=>{o.r(e),o.d(e,{default:()=>f});var r=o(95844);const a={props:{saveMsg:{default:"Модератор добавлен"},form:{type:Object},formAction:{type:Object}},data:function(){return{showPasswordModal:!1,passwordForm:{password:"",password_confirmation:""},permissions:[],errors:new r.D}},methods:{changePassword:function(){var t=this;axios.post("/api/admin/user/"+this.form.id+"/change-password",this.passwordForm).then((function(e){t.$message({message:e.data,type:"success"}),t.showPasswordModal=!1,t.passwordForm.password="",t.passwordForm.password_confirmation=""})).catch((function(e){t.errors.record(e.response.data.errors)}))},getPermissions:function(){var t=this;axios.get("/api/admin/permissions").then((function(e){t.permissions=e.data}))},closeModal:function(t){this.$emit("close",t)},save:function(){var t=this;axios({method:this.formAction.method,url:this.formAction.url,data:this.form}).then((function(e){t.$message({message:t.saveMsg,type:"success"}),t.closeModal()})).catch((function(e){t.errors.record(e.response.data.errors)}))}},mounted:function(){this.getPermissions()}};var s=o(51900);const n=(0,s.Z)(a,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-tabs",{attrs:{type:"card"}},[o("el-tab-pane",{attrs:{label:"Основная информация"}},[o("el-form",{ref:"form",attrs:{model:t.form}},[o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"email",label:"E-mail",error:t.errors.get("email")}},[o("el-input",{attrs:{placeholder:"Электронная почта"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"name",label:"Имя",error:t.errors.get("name")}},[o("el-input",{attrs:{placeholder:"Имя"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"surname",label:"Фамилия"}},[o("el-input",{attrs:{placeholder:"Фамилия"},model:{value:t.form.surname,callback:function(e){t.$set(t.form,"surname",e)},expression:"form.surname"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"last_name",label:"Отчество"}},[o("el-input",{attrs:{placeholder:"Отчество"},model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)],1)],1),t._v(" "),"post"===t.formAction.method?o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"password",label:"Пароль",error:t.errors.get("password")}},[o("el-input",{attrs:{placeholder:"Введите пароль","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"password_confirmation",label:"Подтверждение пароля"}},[o("el-input",{attrs:{placeholder:"Повторите пароль","show-password":""},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1)],1)],1):o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-button",{attrs:{icon:"el-icon-unlock",type:"primary"},on:{click:function(e){t.showPasswordModal=!0}}},[t._v("Сменить пароль")])],1)],1),t._v(" "),o("div",{staticClass:"text-center"},[o("el-button",{attrs:{type:"success"},on:{click:function(e){return e.preventDefault(),t.save.apply(null,arguments)}}},[t._v("Сохранить")]),t._v(" "),o("el-button",{attrs:{type:""},on:{click:function(e){return e.preventDefault(),t.closeModal.apply(null,arguments)}}},[t._v("Отменить")])],1)],1),t._v(" "),o("el-dialog",{attrs:{"append-to-body":"",visible:t.showPasswordModal,title:"Сменить пароль"},on:{"update:visible":function(e){t.showPasswordModal=e}}},[o("el-form",{attrs:{model:t.passwordForm,"label-position":"top"}},[o("div",{staticClass:"row"},[o("el-form-item",{staticClass:"col-md-6",attrs:{label:"Новый пароль",error:t.errors.get("password")}},[o("el-input",{attrs:{"show-password":""},model:{value:t.passwordForm.password,callback:function(e){t.$set(t.passwordForm,"password",e)},expression:"passwordForm.password"}})],1),t._v(" "),o("el-form-item",{staticClass:"col-md-6",attrs:{label:"Подтверждение пароля"}},[o("el-input",{attrs:{"show-password":""},model:{value:t.passwordForm.password_confirmation,callback:function(e){t.$set(t.passwordForm,"password_confirmation",e)},expression:"passwordForm.password_confirmation"}})],1)],1)]),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.showPasswordModal=!1}}},[t._v("Отмена")]),t._v(" "),o("el-button",{attrs:{type:"success"},on:{click:t.changePassword}},[t._v("Сохранить")])],1)],1)],1),t._v(" "),o("el-tab-pane",{attrs:{label:"Права доступа"}},[o("el-checkbox-group",{on:{change:function(t){}},model:{value:t.form.permissions_arr,callback:function(e){t.$set(t.form,"permissions_arr",e)},expression:"form.permissions_arr"}},[o("div",{staticClass:"row"},t._l(t.permissions,(function(e){return"manage_permission"!==e.name?o("div",{staticClass:"col-md-6 mb-2"},[o("el-checkbox",{key:e.name,attrs:{label:e.name}},[t._v(t._s(t.$t("permissions."+e.name)))])],1):t._e()})),0)])],1)],1)}),[],!1,null,null,null).exports,l={components:{ModeratorForm:n},data:function(){return{formAction:{url:"/api/admin/moderators",method:"post"},form:{email:"",name:"",surname:"",last_name:"",password:"",password_confirmation:"",id:null,permissions_arr:[]}}},methods:{closeModal:function(t){this.$emit("close",t)}}};const i=(0,s.Z)(l,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("moderator-form",{attrs:{form:t.form,formAction:t.formAction,closeMsg:"Пользователь добавлен"},on:{close:t.closeModal}})}),[],!1,null,null,null).exports;var c=o(87757),d=o.n(c);function m(t,e,o,r,a,s,n){try{var l=t[s](n),i=l.value}catch(t){return void o(t)}l.done?e(i):Promise.resolve(i).then(r,a)}const u={components:{ModeratorForm:n},props:["id"],data:function(){return{loaded:!1,form:{},formAction:{url:"/api/admin/moderators/"+this.id,method:"put"}}},methods:{closeModal:function(t){this.$emit("close",t)},getFormData:function(){var t=this;return this.$root.isLoading=!0,axios.get("/api/admin/moderators/"+this.id).then((function(e){t.form=e.data,t.loaded=!0,t.$root.isLoading=!1}))}},mounted:function(){var t,e=this;return(t=d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFormData();case 2:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(r,a){var s=t.apply(e,o);function n(t){m(s,r,a,n,l,"next",t)}function l(t){m(s,r,a,n,l,"throw",t)}n(void 0)}))})()}};const p={components:{create:i,edit:(0,s.Z)(u,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",[t.loaded?o("moderator-form",{attrs:{"save-msg":"Пользователь обновлен",form:t.form,formAction:t.formAction},on:{close:t.closeModal}}):t._e()],1)}),[],!1,null,null,null).exports},computed:{moderatorModalTitle:function(){return"create"===this.moderatorModalStatus?"Новый модератор":"edit"===this.moderatorModalStatus?"Обновление данных модератора":void 0}},data:function(){return{id:null,moderatorModal:!1,moderatorModalStatus:"",moderators:[],filters:[{prop:["name","surname","last_name"],value:""}]}},methods:{handleDelete:function(t){var e=this;this.$confirm("Вы уверены что хотите удалить пользователя","Удаление пользователя",{confirmButtonText:"Удалить",cancelButtonText:"Отмена",type:"warning"}).then((function(){axios.delete("/api/admin/moderators/"+t.id).then((function(t){var o=e.moderators.findIndex((function(e){return e.id===t.data.id}));e.moderators.splice(o,1),e.$message({type:"success",message:"Пользователь удален"})}))})).catch((function(){}))},moderatorModalOpen:function(t){this.moderatorModalStatus=t,this.moderatorModal=!0},getModerators:function(){var t=this;axios.get("/api/admin/moderators").then((function(e){t.moderators=e.data}))},closeModal:function(t){this.moderatorModal=!1,this.id=null,this.getModerators()},handleEdit:function(t){this.id=t.id,this.moderatorModalStatus="edit",this.moderatorModal=!0},updateModerator:function(t){}},mounted:function(){this.getModerators()}};const f=(0,s.Z)(p,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"page"},[o("div",{staticClass:"page-heading d-flex align-items-center justify-content-between mb-3"},[o("h1",{staticClass:"page-title mb-0"},[t._v("Модераторы")]),t._v(" "),o("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(e){return t.moderatorModalOpen("create")}}},[t._v("Добавить")])],1),t._v(" "),o("el-row",{staticClass:"mb-3",attrs:{type:"flex"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"large",width:"100%",placeholder:"Поиск: Имя, Фамилия или Отчество"},model:{value:t.filters[0].value,callback:function(e){t.$set(t.filters[0],"value",e)},expression:"filters[0].value"}})],1)],1),t._v(" "),o("data-tables",{attrs:{data:t.moderators,filters:t.filters}},[o("el-table-column",{attrs:{type:"index",label:"№"}}),t._v(" "),o("el-table-column",{attrs:{label:"Фамилия",prop:"surname",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"Имя",prop:"name",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"Отчество",prop:"last_name",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"E-mail",prop:"email",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"Действия"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){return t.handleEdit(e.row)}}},[t._v("Редактировать")]),t._v(" "),1!==e.row.id?o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return t.handleDelete(e.row)}}},[t._v("\n                    Удалить\n                ")]):t._e()]}}])})],1),t._v(" "),o("el-dialog",{attrs:{visible:t.moderatorModal,width:"60%",title:t.moderatorModalTitle},on:{"update:visible":function(e){t.moderatorModal=e}}},[t.moderatorModal&&"create"===t.moderatorModalStatus?o("create",{on:{close:t.closeModal}}):t._e(),t._v(" "),t.moderatorModal&&"edit"===t.moderatorModalStatus?o("edit",{attrs:{id:t.id},on:{close:t.closeModal}}):t._e()],1)],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=400.fb7f4c.js.map