"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[865],{95844:(e,t,o)=>{function r(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}o.d(t,{D:()=>a});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors={}}var t,o,a;return t=e,(o=[{key:"has",value:function(e){return this.errors.hasOwnProperty(e)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(e){if(this.errors[e])return this.errors[e][0]}},{key:"getFlash",value:function(e){if(this.errors[e])return this.errors[e]}},{key:"record",value:function(e){this.errors=e}},{key:"clear",value:function(e){e?this.has(e)&&delete this.errors[e]:this.errors={}}}])&&r(t.prototype,o),a&&r(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}()},2865:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var r=o(95844);const a={props:{saveMsg:{default:"Модератор добавлен"},form:{type:Object},formAction:{type:Object}},data:function(){return{permissions:[],errors:new r.D}},methods:{getPermissions:function(){var e=this;axios.get("/api/admin/permissions").then((function(t){e.permissions=t.data}))},closeModal:function(e){this.$emit("close",e)},save:function(){var e=this;axios({method:this.formAction.method,url:this.formAction.url,data:this.form}).then((function(t){e.$message({message:e.saveMsg,type:"success"}),e.closeModal()})).catch((function(t){e.errors.record(t.response.data.errors)}))}},mounted:function(){this.getPermissions()}};var s=o(51900);const n=(0,s.Z)(a,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-tabs",{attrs:{type:"card"}},[o("el-tab-pane",{attrs:{label:"Основная информация"}},[o("el-form",{ref:"form",attrs:{model:e.form}},[o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"email",label:"E-mail",error:e.errors.get("email")}},[o("el-input",{attrs:{placeholder:"Электронная почта"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"name",label:"Имя",error:e.errors.get("name")}},[o("el-input",{attrs:{placeholder:"Имя"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1)],1),e._v(" "),o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"surname",label:"Фамилия"}},[o("el-input",{attrs:{placeholder:"Фамилия"},model:{value:e.form.surname,callback:function(t){e.$set(e.form,"surname",t)},expression:"form.surname"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"last_name",label:"Отчество"}},[o("el-input",{attrs:{placeholder:"Отчество"},model:{value:e.form.last_name,callback:function(t){e.$set(e.form,"last_name",t)},expression:"form.last_name"}})],1)],1)],1),e._v(" "),"post"===e.formAction.method?o("el-row",{attrs:{type:"flex",gutter:10}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"password",label:"Пароль",error:e.errors.get("password")}},[o("el-input",{attrs:{placeholder:"Введите пароль","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"password_confirmation",label:"Подтверждение пароля"}},[o("el-input",{attrs:{placeholder:"Повторите пароль","show-password":""},model:{value:e.form.password_confirmation,callback:function(t){e.$set(e.form,"password_confirmation",t)},expression:"form.password_confirmation"}})],1)],1)],1):e._e(),e._v(" "),o("div",{staticClass:"text-center"},[o("el-button",{attrs:{type:"success"},on:{click:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[e._v("Сохранить")]),e._v(" "),o("el-button",{attrs:{type:""},on:{click:function(t){return t.preventDefault(),e.closeModal.apply(null,arguments)}}},[e._v("Отменить")])],1)],1)],1),e._v(" "),o("el-tab-pane",{attrs:{label:"Права доступа"}},[o("el-checkbox-group",{on:{change:function(e){}},model:{value:e.form.permissions_arr,callback:function(t){e.$set(e.form,"permissions_arr",t)},expression:"form.permissions_arr"}},[o("div",{staticClass:"row"},e._l(e.permissions,(function(t){return"manage_permission"!==t.name?o("div",{staticClass:"col-md-6 mb-2"},[o("el-checkbox",{key:t.name,attrs:{label:t.name}},[e._v(e._s(e.$t("permissions."+t.name)))])],1):e._e()})),0)])],1)],1)}),[],!1,null,null,null).exports,l={components:{ModeratorForm:n},data:function(){return{formAction:{url:"/api/admin/moderators",method:"post"},form:{email:"",name:"",surname:"",last_name:"",password:"",password_confirmation:"",id:null,permissions_arr:[]}}},methods:{closeModal:function(e){this.$emit("close",e)}}};const i=(0,s.Z)(l,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("moderator-form",{attrs:{form:e.form,formAction:e.formAction,closeMsg:"Пользователь добавлен"},on:{close:e.closeModal}})}),[],!1,null,null,null).exports;var c=o(87757),m=o.n(c);function u(e,t,o,r,a,s,n){try{var l=e[s](n),i=l.value}catch(e){return void o(e)}l.done?t(i):Promise.resolve(i).then(r,a)}const d={components:{ModeratorForm:n},props:["id"],data:function(){return{loaded:!1,form:{},formAction:{url:"/api/admin/moderators/"+this.id,method:"put"}}},methods:{closeModal:function(e){this.$emit("close",e)},getFormData:function(){var e=this;return this.$root.isLoading=!0,axios.get("/api/admin/moderators/"+this.id).then((function(t){e.form=t.data,e.loaded=!0,e.$root.isLoading=!1}))}},mounted:function(){var e,t=this;return(e=m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFormData();case 2:case"end":return e.stop()}}),e)})),function(){var t=this,o=arguments;return new Promise((function(r,a){var s=e.apply(t,o);function n(e){u(s,r,a,n,l,"next",e)}function l(e){u(s,r,a,n,l,"throw",e)}n(void 0)}))})()}};const f={components:{create:i,edit:(0,s.Z)(d,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",[e.loaded?o("moderator-form",{attrs:{"save-msg":"Пользователь обновлен",form:e.form,formAction:e.formAction},on:{close:e.closeModal}}):e._e()],1)}),[],!1,null,null,null).exports},computed:{moderatorModalTitle:function(){return"create"===this.moderatorModalStatus?"Новый модератор":"edit"===this.moderatorModalStatus?"Обновление данных модератора":void 0}},data:function(){return{CanAccess:'Просмотр "Модераторы"',id:null,moderatorModal:!1,moderatorModalStatus:"",moderators:[],filters:[{prop:["name","surname","last_name"],value:""}]}},methods:{handleDelete:function(e){var t=this;this.$confirm("Вы уверены что хотите удалить пользователя","Удаление пользователя",{confirmButtonText:"Удалить",cancelButtonText:"Отмена",type:"warning"}).then((function(){axios.delete("/api/admin/moderators/"+e.id).then((function(e){var o=t.moderators.findIndex((function(t){return t.id===e.data.id}));t.moderators.splice(o,1),t.$message({type:"success",message:"Пользователь удален"})}))})).catch((function(){}))},moderatorModalOpen:function(e){this.moderatorModalStatus=e,this.moderatorModal=!0},getModerators:function(){var e=this;axios.get("/api/admin/moderators").then((function(t){e.moderators=t.data}))},closeModal:function(e){this.moderatorModal=!1,this.id=null,this.getModerators()},handleEdit:function(e){this.id=e.id,this.moderatorModalStatus="edit",this.moderatorModal=!0},updateModerator:function(e){}},mounted:function(){this.getModerators()}};const p=(0,s.Z)(f,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"page"},[o("div",{staticClass:"page-heading d-flex align-items-center justify-content-between mb-3"},[o("h1",{staticClass:"page-title mb-0"},[e._v("Модераторы")]),e._v(" "),o("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){return e.moderatorModalOpen("create")}}},[e._v("Добавить")])],1),e._v(" "),o("el-row",{staticClass:"mb-3",attrs:{type:"flex"}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{size:"large",width:"100%",placeholder:"Поиск: Имя, Фамилия или Отчество"},model:{value:e.filters[0].value,callback:function(t){e.$set(e.filters[0],"value",t)},expression:"filters[0].value"}})],1)],1),e._v(" "),o("data-tables",{attrs:{data:e.moderators,filters:e.filters}},[o("el-table-column",{attrs:{type:"index",label:"№"}}),e._v(" "),o("el-table-column",{attrs:{label:"Фамилия",prop:"surname",sortable:""}}),e._v(" "),o("el-table-column",{attrs:{label:"Имя",prop:"name",sortable:""}}),e._v(" "),o("el-table-column",{attrs:{label:"Отчество",prop:"last_name",sortable:""}}),e._v(" "),o("el-table-column",{attrs:{label:"E-mail",prop:"email",sortable:""}}),e._v(" "),o("el-table-column",{attrs:{label:"Действия"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(o){return e.handleEdit(t.row)}}},[e._v("Редактировать")]),e._v(" "),1!==t.row.id?o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return e.handleDelete(t.row)}}},[e._v("\n                    Удалить\n                ")]):e._e()]}}])})],1),e._v(" "),o("el-dialog",{attrs:{visible:e.moderatorModal,width:"60%",title:e.moderatorModalTitle},on:{"update:visible":function(t){e.moderatorModal=t}}},[e.moderatorModal&&"create"===e.moderatorModalStatus?o("create",{on:{close:e.closeModal}}):e._e(),e._v(" "),e.moderatorModal&&"edit"===e.moderatorModalStatus?o("edit",{attrs:{id:e.id},on:{close:e.closeModal}}):e._e()],1)],1)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=865.d59c16.js.map